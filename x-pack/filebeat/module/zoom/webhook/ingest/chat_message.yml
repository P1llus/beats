description: Pipeline for parsing Zoom chat_message webhooks
processors:
- append:
    field: event.type
    value: info
- append:
    field: event.type
    value: creation
    if: ctx?.event?.action == 'chat_message.sent'
- append:
    field: event.type
    value: deletion
    if: ctx?.event?.action == 'chat_message.deleted'
- append:
    field: event.type
    value: change
    if: ctx?.event?.action == 'chat_message.updated'
- rename:
    field: zoom.object
    target_field: zoom.chat_message
    ignore_missing: true
- append:
    field: related.user
    value: "{{zoom.chat_message.contact_id}}"
    if: "ctx?.zoom?.chat_message?.contact_id != null"
on_failure:
- set:
    field: error.message
    value: '{{ _ingest.on_failure_message }}'
