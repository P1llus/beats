{
  "description" : "VPN and Firewall",
  "processors" : [
    {
      "rename" : {
        "field": "checkpoint.xlatesrc",
        "target_field": "source.nat.ip",
        "ignore_missing": true,
        "if": "ctx.checkpoint?.xlatesrc != '0.0.0.0'"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.xlatedst",
        "target_field": "destination.nat.ip",
        "ignore_missing": true,
        "if": "ctx.checkpoint?.xlatesrc != '0.0.0.0'"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.xlatesport",
        "target_field": "source.nat.port",
        "ignore_missing": true,
        "if": "ctx.checkpoint?.xlatesport != '0'"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.xlatedport",
        "target_field": "destination.nat.port",
        "ignore_missing": true,
        "if": "ctx.checkpoint?.xlatedport != '0'"
      }
    },
    {
      "set" : {
        "field": "event.category",
        "value": "network"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.action",
        "target_field": "event.action",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.rule_uid",
        "target_field": "rule.uuid",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.match_id",
        "target_field": "rule.id",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.service_id",
        "target_field": "network.application",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.outzone",
        "target_field": "observer.egress.zone",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.inzone",
        "target_field": "observer.ingress.zone",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.layer_name",
        "target_field": "network.name",
        "ignore_missing": true
      }
    },
    {
      "set" : {
        "field": "message",
        "value": "Firewall {{checkpoint.rule_action}}"
      }
    },
    {
      "set" : {
        "field": "observer.type",
        "value": "firewall"
      }
    }
  ]
}