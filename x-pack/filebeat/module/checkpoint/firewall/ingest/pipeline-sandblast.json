{
  "description" : "Sandblast Agent",
  "processors" : [
    {
      "set" : {
        "field": "observer.type",
        "value": "endpoint"
      }
    },
    {
      "set" : {
        "field": "event.category",
        "value": "malware"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.host_time",
        "target_field": "event.created",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.os_name",
        "target_field": "host.os.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.os_version",
        "target_field": "host.os.version",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.packet_capture",
        "target_field": "event.url",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.process_md5",
        "target_field": "process.hash.md5",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.process_name",
        "target_field": "process.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.reason",
        "target_field": "message",
        "ignore_missing": true
      }
    },
    {
      "set" : {
        "field": "@timestamp",
        "value": "{{checkpoint.first_detection}}"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.last_detection",
        "target_field": "event.end",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.parent_process_md5",
        "target_field": "process.parent.hash.md5",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.parent_process_name",
        "target_field": "process.parent.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.destination_dns_hostname",
        "target_field": "destination.domain",
        "ignore_missing": true,
        "if": "ctx.checkpoint?.additional_ip == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.smartdefence_profile",
        "target_field": "rule.ruleset",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.additional_ip",
        "target_field": "destination.domain",
        "ignore_missing": true,
        "if": "ctx.checkpoint?.destination_dns_hostname == null"
      }
    }
  ]
}