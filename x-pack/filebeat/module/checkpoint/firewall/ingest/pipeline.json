{
  "description": "...",
  "processors": [
    {
      "grok": {
        "field": "message",
        "patterns": [
          "%{SYSLOG5424PRI}%{NONNEGINT:syslog5424_ver} +(?:%{TIMESTAMP_ISO8601:syslog5424_ts}|-) +(?:%{IPORHOST:syslog5424_host}|-) +(-|%{SYSLOG5424PRINTASCII:syslog5424_app}) +(-|%{SYSLOG5424PRINTASCII:syslog5424_proc}) +(?::-|%{SYSLOG5424PRINTASCII:syslog5424_msgid}) +\\[%{GREEDYDATA:syslog5425_sd}\\]$"
        ]
      }
    },
    {
      "kv": {
        "field": "syslog5425_sd",
        "field_split": "; ",
        "value_split": ":",
        "trim_key": " ",
        "trim_value": " ",
        "prefix": "checkpoint.",
        "strip_brackets": true,
        "exclude_keys": [
          "flags",
          "layer_uuid",
          "originsicname",
          "__policy_id_tag",
          "version",
          "rounded_bytes",
          "db_tag",
          "update_service"
        ]
      }
    },
    {
      "remove": {
        "field": [
          "syslog5425_sd",
          "message",
          "host.architecture",
          "host.containerized",
          "host.hostname",
          "host.id",
          "host.ip",
          "host.mac",
          "host.os.codename",
          "host.os.family",
          "host.os.kernel",
          "host.os.name",
          "host.os.platform",
          "host.os.version"
        ],
        "ignore_missing": true
      }
    },
    {
      "set": {
        "field": "event.created",
        "value": "{{_ingest.timestamp}}"
      }
    },
    {
      "set": {
        "field": "event.module",
        "value": "checkpoint"
      }
    },
    {
      "set": {
        "field": "observer.vendor",
        "value": "Checkpoint"
      }
    },
    {
      "set": {
        "field": "observer.product",
        "value": "{{checkpoint.product}}"
      }
    },
    {
      "rename": {
        "field": "checkpoint.loguid",
        "target_field": "event.id",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.sequencenum",
        "target_field": "event.sequence",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.service",
        "target_field": "destination.port",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.service_id",
        "target_field": "network.application",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.ifdir",
        "target_field": "network.direction",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.src",
        "target_field": "source.ip",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.bytes",
        "target_field": "network.bytes",
        "ignore_missing": true
      }
    },
    {
      "set": {
        "field": "client.ip",
        "value": "{{source.ip}}"
      }
    },
    {
      "rename": {
        "field": "checkpoint.dst",
        "target_field": "destination.ip",
        "ignore_missing": true
      }
    },
    {
      "set": {
        "field": "server.ip",
        "value": "{{destination.ip}}"
      }
    },
    {
      "rename": {
        "field": "checkpoint.client_inbound_interface",
        "target_field": "observer.ingress.interface.name",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.client_inbound_interface",
        "target_field": "observer.egress.interface.name",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.proto",
        "target_field": "network.iana_number",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.s_port",
        "target_field": "source.port",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.severity",
        "target_field": "event.severity",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_type",
        "target_field": "file.type",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_name",
        "target_field": "file.name",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_size",
        "target_field": "file.size",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_md5",
        "target_field": "file.hash.md5",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_sha1",
        "target_field": "file.hash.sha1",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_sha256",
        "target_field": "file.hash.sha256",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.received_bytes",
        "target_field": "destination.bytes",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.sent_bytes",
        "target_field": "source.bytes",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.packets",
        "target_field": "network.packets",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.source_user_name",
        "target_field": "source.user.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.web_client_type",
        "target_field": "user_agent.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.resource",
        "target_field": "url.original",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.http_host",
        "target_field": "url.domain",
        "ignore_missing": true
      }
    },
    {
      "set" : {
        "field": ["client.packets", "source.packets"]
        "target_": "{{checkpoint.client_outbound_packets}}"
        "ignore_missing": true
      }
    },
    {
      "remove" : {
        "field": "checkpoint.client_outbound_packets",
        "ignore_missing": true
      }
    },
    {
      "set" : {
        "field": ["client.bytes", "source.bytes"]
        "target_": "{{checkpoint.client_outbound_bytes}}"
        "ignore_missing": true
      }
    },
    {
      "remove" : {
        "field": "checkpoint.client_outbound_bytes",
        "ignore_missing": true
      }
    },
    {
      "set" : {
        "field": ["server.packets", "destination.packets"]
        "target_": "{{checkpoint.server_outbound_packets}}"
        "ignore_missing": true
      }
    },
    {
      "remove" : {
        "field": "checkpoint.server_outbound_packets",
        "ignore_missing": true
      }
    },
    {
      "set" : {
        "field": ["server.bytes", "destination.bytes"]
        "target_": "{{checkpoint.server_outbound_bytes}}"
        "ignore_missing": true
      }
    },
    {
      "remove" : {
        "field": "checkpoint.server_outbound_bytes",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.to",
        "target_field": "destination.user.email",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.from",
        "target_field": "source.user.email",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.malware_action",
        "target_field": "rule.description",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.matched_category",
        "target_field": "rule.category",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.time",
        "target_field": "@timestamp",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.product_family",
        "target_field": "observer.type",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.reason",
        "target_field": "message",
        "ignore_missing": true
      }
    },
    {
      "pipeline": {
        "if": "ctx.checkpoint.product == 'VPN-1 & FireWall-1'",
        "name": "{< IngestPipeline "pipeline-firewall.json" >}"
      }
    },
    {
      "pipeline": {
        "if": "ctx.checkpoint.product == 'SmartConsole'",
        "name": "{< IngestPipeline "pipeline-console.json" >}"
      }
    },
    {
      "pipeline": {
        "if": "ctx.checkpoint.product == 'Log Update'",
        "name": "{< IngestPipeline "pipeline-log.json" >}"
      }
    },
    {
      "pipeline": {
        "if": "ctx.checkpoint.product == 'Anti Malware'",
        "name": "{< IngestPipeline "pipeline-malware.json" >}"
      }
    }
    {
      "remove" : {
        "field": "checkpoint.product",
        "ignore_missing": true
      }
    },
  ]
}