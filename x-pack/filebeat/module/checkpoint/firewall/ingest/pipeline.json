{
  "description": "...",
  "processors": [
    {
      "grok": {
        "field": "message",
        "patterns": [
          "%{SYSLOG5424PRI}%{NONNEGINT:syslog5424_ver} +(?:%{TIMESTAMP_ISO8601:syslog5424_ts}|-) +(?:%{IPORHOST:syslog5424_host}|-) +(-|%{SYSLOG5424PRINTASCII:syslog5424_app}) +(-|%{SYSLOG5424PRINTASCII:syslog5424_proc}) +(?::-|%{SYSLOG5424PRINTASCII:syslog5424_msgid}) +\\[%{GREEDYDATA:syslog5425_sd}\\]$"
        ]
      }
    },
    {
      "kv": {
        "field": "syslog5425_sd",
        "field_split": "; ",
        "value_split": ":",
        "trim_key": " ",
        "trim_value": " ",
        "prefix": "checkpoint.",
        "strip_brackets": true,
        "exclude_keys": [
          "flags",
          "layer_uuid",
          "originsicname",
          "__policy_id_tag",
          "version",
          "rounded_bytes",
          "db_tag",
          "update_service"
        ]
      }
    },
    {
      "remove": {
        "field": [
          "syslog5425_sd",
          "message",
          "host.architecture",
          "host.containerized",
          "host.hostname",
          "host.id",
          "host.ip",
          "host.mac",
          "host.os.codename",
          "host.os.family",
          "host.os.kernel",
          "host.os.name",
          "host.os.platform",
          "host.os.version"
        ],
        "ignore_missing": true
      }
    },
    {
      "set": {
        "field": "event.module",
        "value": "checkpoint"
      }
    },
    {
      "set": {
        "field": "observer.vendor",
        "value": "Checkpoint"
      }
    },
    {
      "set": {
        "field": "observer.product",
        "value": "{{checkpoint.product}}",
        "if": "ctx.checkpoint?.product != null"
      }
    },
    {
      "set": {
        "field": "client.ip",
        "value": "{{checkpoint.src}}",
        "if": "ctx.checkpoint?.src != null"
      }
    },
    {
      "set": {
        "field": "source.ip",
        "value": "{{checkpoint.src}}",
        "if": "ctx.checkpoint?.src != null"
      }
    },
    {
      "set": {
        "field": "server.ip",
        "value": "{{checkpoint.dst}}",
        "if": "ctx.checkpoint?.dst != null"
      }
    },
    {
      "set": {
        "field": "destination.ip",
        "value": "{{checkpoint.dst}}",
        "if": "ctx.checkpoint?.dst != null"
      }
    },
    {
      "set" : {
        "field": "client.user.id",
        "value": "{{checkpoint.uid}}",
        "if": "ctx.checkpoint?.uid != null"
      }
    },
    {
      "set" : {
        "field": "source.user.id",
        "value": "{{checkpoint.uid}}",
        "if": "ctx.checkpoint?.uid != null"
      }
    },
    {
      "set" : {
        "field": "client.user.name",
        "value": "{{checkpoint.administrator}}",
        "if": "ctx.checkpoint?.administrator != null"
      }
    },
    {
      "set" : {
        "field": "source.user.name",
        "value": "{{checkpoint.administrator}}",
        "if": "ctx.checkpoint?.administrator != null"
      }
    },
    {
      "set" : {
        "field": "source.packets",
        "value": "{{ctx.checkpoint?.client_outbound_packets}}",
        "if": "ctx.checkpoint?.client_outbound_packets != null"
      }
    },
    {
      "set" : {
        "field": "client.packets",
        "value": "{{ctx.checkpoint?.client_outbound_packets}}",
        "if": "ctx.checkpoint?.client_outbound_packets != null"
      }
    },
    {
      "set" : {
        "field": "destination.packets",
        "value": "{{checkpoint.server_outbound_packets}}",
        "if": "ctx.checkpoint?.server_outbound_packets != null"
      }
    },
    {
      "set" : {
        "field": "server.packets",
        "value": "{{checkpoint.server_outbound_packets}}",
        "if": "ctx.checkpoint?.server_outbound_packets != null"
      }
    },
    {
      "set" : {
        "field": "client.bytes",
        "value": "{{checkpoint.client_outbound_bytes}}",
        "if": "ctx.checkpoint?.client_outbound_bytes != null"
      }
    },
    {
      "set" : {
        "field": "source.bytes",
        "value": "{{checkpoint.client_outbound_bytes}}",
        "if": "ctx.checkpoint?.client_outbound_bytes != null"
      }
    },
    {
      "set" : {
        "field": "destination.bytes",
        "value": "{{checkpoint.server_outbound_bytes}}",
        "if": "ctx.checkpoint?.server_outbound_bytes != null"
      }
    },
    {
      "set" : {
        "field": "server.bytes",
        "value": "{{checkpoint.server_outbound_bytes}}",
        "if": "ctx.checkpoint?.server_outbound_bytes != null"
      }
    },
    {
      "rename": {
        "field": "checkpoint.service",
        "target_field": "destination.port",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.received_bytes",
        "target_field": "destination.bytes",
        "ignore_missing": true,
        "if": "ctx.destination?.bytes == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.to",
        "target_field": "destination.user.email",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.xlatedst",
        "target_field": "destination.nat.ip",
        "ignore_missing": true,
        "if": "ctx.checkpoint?.xlatedst != '0.0.0.0'"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.xlatedport",
        "target_field": "destination.nat.port",
        "ignore_missing": true,
        "if": "ctx.checkpoint?.xlatedport != '0'"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.destination_dns_hostname",
        "target_field": "destination.domain",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.dst_machine_name",
        "target_field": "destination.domain",
        "ignore_missing": true,
        "if": "ctx.event?.destination?.domain == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.usercheck_incident_uid",
        "target_field": "destination.user.id",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.service_name",
        "target_field": "destination.service.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.mac_destination_address",
        "target_field": "destination.mac",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.dns_type",
        "target_field": "dns.question.type",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.domain_name",
        "target_field": "dns.question.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.dns_message_type",
        "target_field": "dns.type",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.tid",
        "target_field": "dns.id",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.loguid",
        "target_field": "event.id",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.sequencenum",
        "target_field": "event.sequence",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.severity",
        "target_field": "event.severity",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.action",
        "target_field": "event.action",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.packet_capture",
        "target_field": "event.url",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.start_time",
        "target_field": "event.start",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.first_detection",
        "target_field": "event.start",
        "ignore_missing": true,
        "if": "ctx.event?.start == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.last_detection",
        "target_field": "event.end",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.app_risk",
        "target_field": "event.risk_score",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.file_id",
        "target_field": "file.inode",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_type",
        "target_field": "file.type",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_name",
        "target_field": "file.name",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_size",
        "target_field": "file.size",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_md5",
        "target_field": "file.hash.md5",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_sha1",
        "target_field": "file.hash.sha1",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.file_sha256",
        "target_field": "file.hash.sha256",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.dlp_file_name",
        "target_field": "file.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.user_group",
        "target_field": "group.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.os_version",
        "target_field": "host.os.version",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.os_name",
        "target_field": "host.os.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.method",
        "target_field": "http.request.method",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.status",
        "target_field": "http.response.status_code",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.referrer",
        "target_field": "http.request.referrer",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.service_id",
        "target_field": "network.application",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.ifdir",
        "target_field": "network.direction",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.bytes",
        "target_field": "network.bytes",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.proto",
        "target_field": "network.iana_number",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.packets",
        "target_field": "network.packets",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.layer_name",
        "target_field": "network.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.app_name",
        "target_field": "network.application",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.client_inbound_interface",
        "target_field": "observer.ingress.interface.name",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.client_inbound_interface",
        "target_field": "observer.egress.interface.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.type",
        "target_field": "observer.type",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.endpoint_ip",
        "target_field": "observer.ip",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.outzone",
        "target_field": "observer.egress.zone",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.inzone",
        "target_field": "observer.ingress.zone",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.security_outzone",
        "target_field": "observer.egress.zone",
        "ignore_missing": true,
        "if": "ctx.observer?.egress?.zone == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.security_inzone",
        "target_field": "observer.ingress.zone",
        "ignore_missing": true,
        "if": "ctx.observer?.ingress?.zone == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.update_version",
        "target_field": "observer.version",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.process_md5",
        "target_field": "process.hash.md5",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.process_name",
        "target_field": "process.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.parent_process_md5",
        "target_field": "process.parent.hash.md5",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.parent_process_name",
        "target_field": "process.parent.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.matched_category",
        "target_field": "rule.category",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.categories",
        "target_field": "rule.category",
        "ignore_missing": true,
        "if": "ctx.rule?.category == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.malware_action",
        "target_field": "rule.description",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.match_id",
        "target_field": "rule.id",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.malware_rule_id",
        "target_field": "rule.id",
        "ignore_missing": true,
        "if": "ctx.rule?.id == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.app_rule_id",
        "target_field": "rule.id",
        "ignore_missing": true,
        "if": "ctx.rule?.id == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.objectname",
        "target_field": "rule.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.rule_name",
        "target_field": "rule.name",
        "ignore_missing": true,
        "if": "ctx.rule?.name == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.malware_rule_name",
        "target_field": "rule.name",
        "ignore_missing": true,
        "if": "ctx.rule?.name == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.app_rule_name",
        "target_field": "rule.name",
        "ignore_missing": true,
        "if": "ctx.rule?.name == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.dlp_rule_name",
        "target_field": "rule.name",
        "ignore_missing": true,
        "if": "ctx.rule?.name == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.smartdefence_profile",
        "target_field": "rule.ruleset",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.policy",
        "target_field": "rule.ruleset",
        "ignore_missing": true,
        "if": "ctx.rule?.ruleset == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.rule_uid",
        "target_field": "rule.uuid",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.dlp_rule_uid",
        "target_field": "rule.uuid",
        "ignore_missing": true,
        "if": "ctx.rule?.uuid == null"
      }
    },
    {
      "rename": {
        "field": "checkpoint.src",
        "target_field": "source.ip",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.s_port",
        "target_field": "source.port",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.sent_bytes",
        "target_field": "source.bytes",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.mac_source_address",
        "target_field": "source.mac",
        "ignore_missing": true
      }
    },
    {
      "rename": {
        "field": "checkpoint.source_user_name",
        "target_field": "source.user.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.from",
        "target_field": "source.user.email",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.xlatesrc",
        "target_field": "source.nat.ip",
        "ignore_missing": true,
        "if": "ctx.checkpoint?.xlatesrc != '0.0.0.0'"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.xlatesport",
        "target_field": "source.nat.port",
        "ignore_missing": true,
        "if": "ctx.checkpoint?.xlatesport != '0'"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.src_machine_name",
        "target_field": "source.domain",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.src_user_group",
        "target_field": "source.user.group.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.url",
        "target_field": "url.original",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.resource",
        "target_field": "url.original",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.http_host",
        "target_field": "url.domain",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.web_client_type",
        "target_field": "user_agent.name",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.user_agent",
        "target_field": "user_agent.original",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.industry_reference",
        "target_field": "vulnerability.id",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.time",
        "target_field": "@timestamp",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.message",
        "target_field": "message",
        "ignore_missing": true
      }
    },
    {
      "rename" : {
        "field": "checkpoint.reason",
        "target_field": "message",
        "ignore_missing": true,
        "if": "ctx.message == null"
      }
    },
    {
      "rename" : {
        "field": "checkpoint.subject",
        "target_field": "message",
        "ignore_missing": true,
        "if": "ctx.message == null"
      }
    },
    {
      "remove" : {
        "field": ["checkpoint.client_outbound_packets", "checkpoint.client_outbound_bytes", "checkpoint.server_outbound_packets", "checkpoint.server_outbound_bytes", "checkpoint.product", "checkpoint.uid", "checkpoint.administrator"],
        "ignore_missing": true
      }
    }
  ]
}