description: Pipeline to parse repository_vulnerability_alert github wehhooks
processors:
- append:
    field: event.type
    value: creation
    if: ctx.github?.action == 'create'
- append:
    field: event.type
    value: change
    if: "['dismiss', 'resolve'].contains(ctx.github?.action)"
- remove:
    field: event.kind
    ignore_missing: true
- set:
    field: event.kind
    value: alert
- set:
    field: event.action
    value: repository_vulnerability_alert-{{github.action}}
- remove:
    field:
    - github.repository
    - github.organization
    - github.sender
    ignore_missing: true
on_failure:
- set:
    field: error.message
    value: '{{ _ingest.on_failure_message }}'
