description: Pipeline to parse milestone github wehhooks
processors:
- append:
    field: event.type
    value: creation
    if: ctx.github?.action == 'added'
- append:
    field: event.type
    value: change
    if: '[''edited'', ''closed'', ''reopened''].contains(ctx.github?.action)'
- append:
    field: event.type
    value: deletion
    if: ctx.github?.action == 'deleted'
- set:
    field: event.outcome
    value: success
- set:
    field: event.kind
    value: event
- set:
    field: event.action
    value: organization-{{github.action}}
- rename:
    field: github.project_card.url
    target_field: event.url
    ignore_missing: true
- rename:
    field: github.sender.login
    target_field: source.user.name
    ignore_missing: true
- rename:
    field: github.sender.id
    target_field: source.user.id
    ignore_missing: true
on_failure:
- set:
    field: error.message
    value: '{{ _ingest.on_failure_message }}'
