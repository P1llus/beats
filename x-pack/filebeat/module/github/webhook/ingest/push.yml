description: Pipeline to parse milestone github wehhooks
processors:
- append:
    field: event.type
    value: creation
    if: ctx.github?.created == 'true'
- append:
    field: event.type
    value: deletion
    if: ctx.github?.deleted == 'true'
- set:
    field: event.action
    value: push-action
- rename:
    field: github.ref
    target_field: github.push.ref
    ignore_missing: true
- rename:
    field: github.forced
    target_field: github.push.forced
    ignore_missing: true
- rename:
    field: github.pusher.name
    target_field: github.related.user.name
    ignore_missing: true
- remove:
    field:
    - github.commits
    - github.repository
    - github.organization
    - github.installation
    - github.sender
    ignore_missing: true
on_failure:
- set:
    field: error.message
    value: '{{ _ingest.on_failure_message }}'
