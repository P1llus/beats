description: Pipeline to parse delete github wehhooks
processors:
- append:
    field: event.type
    value:
    - info
    - deletion
- set:
    field: event.outcome
    value: success
- set:
    field: event.kind
    value: event
- set:
    field: event.action
    value: delete-{{github.ref_type}}
- append:
    field: github.related.ref
    value: "{{github.ref}}"
    ignore_missing: true
- remove:
    field:
    - github.repository
    - github.organization
    - github.installation
    - github.sender
    ignore_missing: true
on_failure:
- set:
    field: error.message
    value: '{{ _ingest.on_failure_message }}'
