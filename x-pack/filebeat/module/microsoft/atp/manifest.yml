module_version: 1.0

var:
  - name: input
    default: httpjson
  - name: http_method
    default: GET
  - name: interval
    default: 5m
  - name: json_objects_array
    default: value
  - name: url
    default: "https://api.securitycenter.windows.com/api/alerts"
  - name: http_headers
    default: |-
      {"Content-Type": "application/json"}
  
  - name: oauth2
    default: 
      provider: azure
      azure.resource: https://api.securitycenter.windows.com/

  - name: ssl
    default: |-
      {}

ingest_pipeline: ingest/pipeline.json
input: config/atp.yml

requires.processors:
- name: decode_json_fields
  fields: [message]
  target: json

